# Getting Started with Personal RAG

Welcome! This guide will walk you through setting up your Personal RAG system from scratch. By the end, you'll have a powerful AI assistant that can answer questions about your own documents.

## What is Personal RAG?

Personal RAG is a system that:
1. **Indexes** your documents (local files, Google Drive, etc.)
2. **Searches** them intelligently when you ask questions
3. **Answers** using AI (GPT-5) based on your actual documents

Think of it as "ChatGPT, but trained on your personal knowledge base."

## What You'll Need

Before starting, make sure you have:

- **macOS or Linux** (Windows works with minor adjustments)
- **Python 3.11 or higher** - Check with `python3 --version`
- **An OpenAI API key** - Get one at [platform.openai.com](https://platform.openai.com/)
  - You'll need a paid account with credits
  - Typical cost: ~$0.01 per 1000 documents indexed, ~$0.01-0.02 per query
- **15 minutes** for initial setup

Optional:
- Google account (for Google Drive integration)
- Some documents to index (we'll help you create test files if needed)

---

## Step 1: Installation

### 1.1 Install uv (Package Manager)

We use `uv` for fast, reliable Python package management:

```bash
curl -LsSf https://astral.sh/uv/install.sh | sh
```

After installation, close and reopen your terminal.

### 1.2 Clone or Download the Project

If you have the code:
```bash
cd personal-rag
```

If you need to clone it:
```bash
git clone <repository-url>
cd personal-rag
```

### 1.3 Create Virtual Environment

```bash
# Create virtual environment
uv venv

# Activate it (macOS/Linux)
source .venv/bin/activate

# On Windows:
# .venv\Scripts\activate
```

You should see `(.venv)` in your terminal prompt.

### 1.4 Install Dependencies

```bash
uv pip install -e .
```

This installs all required packages (~2 minutes).

---

## Step 2: Configuration

### 2.1 Create Configuration File

```bash
cp .env.example .env
```

### 2.2 Add Your OpenAI API Key

Open `.env` in your text editor and add your API key:

```bash
OPENAI_API_KEY=sk-proj-your-actual-key-here
```

**Important**: Keep this key secret! Never commit `.env` to git.

### 2.3 Create Data Directory

```bash
mkdir -p data/chroma
```

This is where your indexed documents will be stored.

---

## Step 3: Your First Ingestion (Local Files)

Let's start by indexing some local files. This is the easiest way to test the system.

### 3.1 Prepare Test Documents

Create a test directory with some sample files:

```bash
mkdir -p ~/test-rag-docs
```

Create a few test files:

```bash
# Create a sample note
cat > ~/test-rag-docs/python-notes.txt << 'EOF'
Python is a high-level programming language.
It's known for its simple syntax and readability.
Popular frameworks include Django and Flask for web development.
EOF

# Create another sample
cat > ~/test-rag-docs/work-notes.txt << 'EOF'
Team meeting scheduled for Monday 10am.
Project deadline is end of Q4.
Need to review the new feature proposals.
EOF
```

Or use your own documents (`.txt`, `.md`, `.pdf`, `.docx` files).

### 3.2 Ingest the Documents

```bash
python ingest.py --source ~/test-rag-docs --source-type local
```

You should see output like:
```
Processing local files from ~/test-rag-docs
Found 2 documents
Processing: python-notes.txt
Processing: work-notes.txt
âœ“ Successfully ingested 2 documents (4 chunks)
```

### 3.3 Verify What's Indexed

```bash
python ingest.py --stats
```

Output:
```
Collection: personal_docs
Total chunks: 4
Total unique documents: 2
```

**Congratulations!** Your documents are now indexed. ðŸŽ‰

---

## Step 4: Your First Query

Now let's ask questions about your documents.

### 4.1 Try the Chat UI (Recommended)

Start the Streamlit chat interface:

```bash
streamlit run app.py
```

Your browser should open to `http://localhost:8501`.

**Try asking:**
- "What programming languages are mentioned?"
- "When is the team meeting?"
- "Tell me about Python frameworks"

You'll see:
- AI-generated answers based on your documents
- Source citations showing which documents were used
- Metadata about each source

### 4.2 Or Use the Command Line

If you prefer CLI:

```bash
python query.py "What did I write about Python?"
```

You'll get:
```
Answer: Based on your notes, Python is a high-level programming
language known for its simple syntax and readability. You mentioned
that popular frameworks include Django and Flask for web development.

Sources:
1. python-notes.txt (score: 0.89)
```

### 4.3 Understanding the Results

- **Answer**: Generated by GPT-5 using your documents as context
- **Sources**: Which documents the AI used to generate the answer
- **Score**: Similarity score (0-1, higher = more relevant)

**Note**: First query takes 30-80 seconds due to GPT-5 processing time. This is normal!

---

## Step 5: Google Drive Setup (Optional)

Want to index your Google Drive documents? Follow this section.

### 5.1 Prerequisites

You'll need:
- A Google account
- 10-15 minutes for OAuth setup

### 5.2 Complete OAuth Configuration

We have a detailed guide for this. Follow: **[GOOGLE-OAUTH.md](GOOGLE-OAUTH.md)**

The guide walks you through:
1. Creating a Google Cloud project
2. Enabling the Drive API
3. Setting up OAuth credentials
4. Downloading `credentials.json`

### 5.3 First Google Drive Ingestion

After completing OAuth setup:

```bash
# List your Drive folders (optional, to explore)
python ingest.py --source-type gdrive --list-folders

# Ingest recently accessed files (recommended for first run)
python ingest.py --source-type gdrive --mode=accessed --max-results 50
```

The first time:
1. Your browser will open
2. Sign in to Google
3. Grant permissions
4. Return to terminal

The system will:
- Fetch your 50 most recently accessed files
- Download and process them
- Store embeddings in ChromaDB

**This may take 5-10 minutes** depending on document count.

### 5.4 Verify Google Drive Documents

```bash
# Check stats
python ingest.py --stats

# Query a Drive document
python query.py "what's in my meeting notes?"
```

### 5.5 Alternative: Use Google Drive Desktop

**Simpler option:** If you use [Google Drive Desktop](https://www.google.com/drive/download/), you can skip OAuth and ingest the synced folder directly:

```bash
python ingest.py --source ~/Google\ Drive/My\ Drive --source-type local
```

---

## Step 6: Automated Ingestion (Daemon)

Want your documents to stay up-to-date automatically? Set up the background daemon.

### 6.1 What is the Daemon?

The daemon:
- Runs in the background
- Checks Google Drive every 30-60 minutes
- Automatically ingests new/changed documents
- Only runs when your Mac is awake (or plugged in)
- Shows a dashboard at `http://localhost:8001`

### 6.2 Start the Daemon

```bash
python daemon.py
```

You should see:
```
Starting Personal RAG Daemon on http://localhost:8001
Scheduler started: running every 60 minutes (awake-only mode)
Press Ctrl+C to stop
```

### 6.3 Access the Dashboard

Open your browser to: **http://localhost:8001**

The dashboard shows:
- **Status**: Running/paused, next run time
- **Configuration**: Interval (10/30/60 min), mode (awake/plugged-in)
- **Last Run**: Success/failure, documents processed
- **History**: Last 20 ingestion runs

### 6.4 Configure Sources

The daemon can watch multiple sources:

**Add Google Drive folder:**
1. Open `http://localhost:8001`
2. Connect Google Drive (if not already)
3. Click "+ Add Source"
4. Name it (e.g., "Work Drive")
5. Select Google Drive
6. Configure folder and time range
7. Save

**Add local directory:**
1. Click "+ Add Source"
2. Name it (e.g., "Personal Notes")
3. Select Local Directory
4. Enter path: `/Users/yourname/Documents/notes`
5. Save

The daemon will process all enabled sources each run, prioritizing Google Drive.

### 6.5 Configure the Daemon

**Via Dashboard:**
- Click on interval/mode dropdowns
- Click "Update Configuration"

**Via CLI:**
```bash
# Change to run every 30 minutes
python daemon_cli.py config --interval 30

# Only run when plugged into AC power
python daemon_cli.py config --mode plugged-in-only

# Check status
python daemon_cli.py status
```

### 6.6 Recommended Settings

**For most users:**
- Interval: 60 minutes
- Mode: awake-only
- Max results: 100

**For heavy Drive users:**
- Interval: 30 minutes
- Mode: plugged-in-only (saves battery)
- Max results: 200

### 6.6 Manual Trigger

Want to ingest right now? Trigger manually:

**Via Dashboard:** Click "Trigger Now"

**Via CLI:**
```bash
python daemon_cli.py trigger
```

### 6.7 View Logs

```bash
# Via CLI
python daemon_cli.py logs --tail 50

# Or directly
tail -f logs/daemon.log
```

---

## What's Next?

You now have a working Personal RAG system! Here are some next steps:

### Explore More Features

- **Filter queries**: `python query.py "question" --source-type gdrive`
- **Adjust results**: `python query.py "question" --top-k 10`
- **Reset collection**: `python ingest.py --source ~/docs --source-type local --reset`
- **API access**: `python api.py` (REST API on port 8000)

### Read Advanced Documentation

- **[README.md](README.md)** - Complete feature reference
- **[CLAUDE.md](CLAUDE.md)** - Developer quick reference
- **[docs/DAEMON.md](docs/DAEMON.md)** - Advanced daemon configuration
- **[GOOGLE-OAUTH.md](GOOGLE-OAUTH.md)** - Detailed OAuth setup

### Customize Configuration

Edit `.env` to customize:
- Chunk size: `CHUNK_SIZE=512`
- Embedding model: `EMBEDDING_MODEL=text-embedding-3-small`
- LLM model: `LLM_MODEL=gpt-5`
- Temperature: `LLM_TEMPERATURE=0.7`

See [README.md#configuration](README.md#configuration) for all options.

### Run Tests

Before making changes, run the test suite:

```bash
# Activate environment
source .venv/bin/activate

# Run all tests
pytest tests/ --ignore=tests/e2e/
```

See [README.md#development](README.md#development) for testing details.

---

## Troubleshooting

### "No module named X" errors

```bash
# Reinstall dependencies
source .venv/bin/activate
uv pip install -e .
```

### "Empty results" when querying

**Possible causes:**
1. No documents indexed - Check: `python ingest.py --stats`
2. Wrong OpenAI key - Verify `.env` has correct `OPENAI_API_KEY`
3. Score threshold too high - Try: `python query.py "question" --min-score 0`

### Google Drive authentication fails

1. Check `credentials.json` is in the project root
2. Delete `token.json` and try again
3. See [GOOGLE-OAUTH.md](GOOGLE-OAUTH.md) for detailed troubleshooting

### Streamlit won't start

```bash
# Kill existing Streamlit processes
pkill -f streamlit

# Restart
streamlit run app.py
```

### Daemon not ingesting

```bash
# Check status
python daemon_cli.py status

# Check if paused
python daemon_cli.py resume

# View logs
python daemon_cli.py logs --tail 50
```

### More Help

See [README.md#troubleshooting](README.md#troubleshooting) for comprehensive troubleshooting.

---

## Quick Reference

### Common Commands

```bash
# Activate environment (do this first!)
source .venv/bin/activate

# Ingest local files
python ingest.py --source ~/Documents --source-type local

# Ingest Google Drive (recently accessed)
python ingest.py --source-type gdrive --mode=accessed --max-results 100

# Check what's indexed
python ingest.py --stats

# Query via chat UI
streamlit run app.py

# Query via CLI
python query.py "your question here"

# Start daemon
python daemon.py

# Daemon status
python daemon_cli.py status

# Run tests
pytest tests/ --ignore=tests/e2e/
```

### File Locations

- **Config**: `.env`
- **Database**: `data/chroma/`
- **Google OAuth**: `credentials.json`, `token.json`
- **Logs**: `logs/daemon.log`
- **Daemon state**: `data/daemon.db`

### Getting Help

1. Check this guide first
2. Read [README.md](README.md) for detailed documentation
3. Check [docs/](docs/) folder for specific topics
4. Review test files in [tests/](tests/) for examples

---

## Success Checklist

By now you should have:

- âœ… Installed Python, uv, and all dependencies
- âœ… Created `.env` with OpenAI API key
- âœ… Ingested local test documents
- âœ… Successfully queried your documents via Streamlit
- âœ… (Optional) Set up Google Drive OAuth
- âœ… (Optional) Started the background daemon

**You're all set!** Start indexing your real documents and enjoy your personal AI assistant.

---

**Questions or issues?** Check the [README.md](README.md) or review the code in `src/` for implementation details.

**Built with Claude Code** ðŸ¤–
